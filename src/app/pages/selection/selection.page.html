<ion-header>
  <ion-toolbar color="danger">
    <ion-title>Test Selection</ion-title>
    <ion-buttons slot="start">
      <ion-menu-button menu="first" aria-disabled="false" aria-hidden="false"></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid class="ion-text-center">
    <ion-row>
      <ion-col>
        <p>{{log}}</p>
      </ion-col>
    </ion-row>
    <ion-row className="ion-text-center ion-align-items-center">
      <ion-col>
        <ion-card>
          <ion-card-header mode="ios" className="cardhead">
            <ion-row>
              <ion-col>
                <ion-card-title>
                  <ion-icon slot="start" name="sync"></ion-icon>
                  Current Assets
                </ion-card-title>
              </ion-col>
            </ion-row>
          </ion-card-header>
          <ion-slides pager="false" mode="ios" [options]="(desktop)? slideOpts: mobSlideOpts" (ionSlideReachEnd)="loadMore($event)">
            <ion-slide *ngFor="let item of table">
          <ion-card className="slidecard">
            <ion-card-header className="cardhead">
              <ion-col>
                <ion-card-title>
                  {{item.id}}
                </ion-card-title>
              </ion-col>
              <ion-col >
                <div className="slidestatus">
                  <ion-label [color]="item.Status == 'Functions' ? 'success' : 'danger' ">{{item.Status}}</ion-label> 
                </div>
              </ion-col>
            </ion-card-header>
            
            <ion-card-content>
              <ion-row>
                <ion-col className="ion-align-items-center" (click)="getTests(item.id, item.noOfTests)">
                  <ion-label>Assigned tests: </ion-label>
                  <ion-badge [ngClass]="{zero: item.noOfTests == 0, one: item.noOfTests >=1}">{{item.noOfTests}}</ion-badge>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col className="ion-align-items-center" (click)="getRepairs(item.id, item.noOfRepairs)">
                  <ion-label>Ongoing repairs: </ion-label>
                    <ion-badge [ngClass]="{zero: item.noOfRepairs == 0, one: item.noOfRepairs >=1}">{{item.noOfRepairs}}</ion-badge>
                </ion-col>
              </ion-row> 
              <ion-row>
                <ion-col>
                  <ion-button [disabled]="item.noOfTests >= 2" *ngIf="empRole == 'Manager' && item.Status == 'Functions'" color="danger" [routerLink]="['/','create-inspection',item.id]">
                    Assign
                  </ion-button>
                  <ion-button *ngIf="empRole == 'Manager' && item.Status != 'Functions'" color="success" (click)="setAssetAsFunctional(item.id)">
                    Fixed
                  </ion-button>
                </ion-col>
              </ion-row>
            </ion-card-content>
          </ion-card>
        </ion-slide>
        <ion-slide *ngIf="nextpg"></ion-slide>
        </ion-slides>
        </ion-card>
      </ion-col>
    </ion-row> 
    <!--tests table-->
    <ion-row *ngIf="tests.length > 0" className="ion-text-center ion-align-items-center">
      <ion-col>
        <ion-card>
          <ion-card-header className="cardhead">
            <ion-row>
              <ion-col size="3">
                <ion-card-subtitle class="ion-text-wrap">Test No</ion-card-subtitle>
              </ion-col>
              <ion-col size="3">
                <ion-card-subtitle class="ion-text-wrap">Manager ID</ion-card-subtitle>
              </ion-col>
              <ion-col size="3">
                <ion-card-subtitle class="ion-text-wrap">Inspector ID</ion-card-subtitle>
              </ion-col>
              <ion-col size="3">
                <ion-card-subtitle class="ion-text-wrap">Test Module ID</ion-card-subtitle>
              </ion-col>
            </ion-row>
          </ion-card-header>
          <ion-card-content *ngFor="let item of tests">
            <ion-row>
              <ion-col>
                <ion-label color="success" mode="ios">{{item.TestID}}</ion-label> 
              </ion-col>
              <ion-col>
                <ion-label>{{item.ManagerID}}</ion-label> 
              </ion-col>
              <ion-col>
                <ion-label>{{item.InspectorID}}</ion-label> 
              </ion-col>
              <ion-col>
                <ion-label>{{item.TestModID}}</ion-label> 
              </ion-col>
            </ion-row>            
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row> 
    <!--Repairs table-->
    <ion-row *ngIf="repairs.length > 0" className="ion-text-center ion-align-items-center">
      <ion-col>
        <ion-card>
          <ion-card-header className="cardhead">
            <ion-row>
              <ion-col size="4">
                <ion-card-subtitle class="ion-text-wrap">Created Date</ion-card-subtitle>
              </ion-col>
              <ion-col size="4">
                <ion-card-subtitle class="ion-text-wrap">Engineer ID</ion-card-subtitle>
              </ion-col>
              <ion-col size="4">
                <ion-card-subtitle class="ion-text-wrap">Comments</ion-card-subtitle>
              </ion-col>
            </ion-row>
          </ion-card-header>
          <ion-card-content *ngFor="let item of repairs">
            <ion-row>
              <ion-col>
                <ion-label color="success" mode="ios"> {{this.datePipe.transform(item.CreatedDate, 'MMM d, y')}}</ion-label> 
              </ion-col>
              <ion-col>
                <ion-label>{{item.EngineerID}}</ion-label> 
              </ion-col>
              <ion-col>
                <ion-label>{{item.comments}}</ion-label> 
              </ion-col>
            </ion-row>            
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row> <!---->
      <ion-row *ngIf="empRole == 'Manager'">
        <ion-col>
            <ion-button className="alltest" [routerLink]="['/','create-asset']" color="danger" expand="block"  >
                <ion-icon name="add" slot="icon-only"></ion-icon>
                Create Asset
            </ion-button>
        </ion-col>
      </ion-row>
      <ion-row *ngIf="empRole == 'Manager'">
        <ion-col>
        <ion-button [routerLink]="['/','create-inspection']" fill="solid" color="danger" expand="block">
            <ion-icon name="globe" slot="icon-only" size="large"></ion-icon>
            Create Tests</ion-button>
        </ion-col>
      </ion-row>
      <!---->
      <ion-row class="text-class-center">
        <ion-col class="text-class-center" size="6">
          <ion-button fill="clear" class="squarebutton" [routerLink]="['/','grounds-test']">
            <div class="divclass">
          <ion-icon name="flash-off" size="large"></ion-icon>
          <br/>
          Grounds<br/> Tests
          </div>
        </ion-button>
        </ion-col>

        
        <ion-col class="text-class-center" size="6">
          <ion-button fill="clear" class="squarebutton" [routerLink]="['/','signal-test']">
            <div class="divclass">
          <ion-icon name="megaphone" size="large"></ion-icon>
          <br/>
          Signal<br/> Tests
            </div>
          </ion-button>
        </ion-col>
      </ion-row>
      
</ion-grid>
</ion-content>
